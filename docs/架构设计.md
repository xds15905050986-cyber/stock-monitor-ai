# è‚¡ç¥¨ç›‘æ§ç³»ç»Ÿ V1.0 - å®Œæ•´æ•°æ®åº“è®¾è®¡ä¸æ¥å£æ–‡æ¡£

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®åº“è¡¨ç»“æ„è®¾è®¡ï¼ˆå…± 6 å¼ è¡¨ï¼‰

### 1. ç”¨æˆ·è¡¨ (`users`)

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | ä¸­æ–‡è¯´æ˜ | ä¸¾ä¾‹ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `id` | INTEGER | æ˜¯ | è‡ªå¢ | ç”¨æˆ·ç¼–å·ï¼ˆä¸»é”®ï¼‰ | 1, 2, 3 |
| `username` | TEXT | æ˜¯ | - | ç™»å½•ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰ | `zhangsan` |
| `password_hash` | TEXT | æ˜¯ | - | åŠ å¯†åçš„å¯†ç  | `sha256:xxx` |
| `role` | TEXT | æ˜¯ | `user` | ç”¨æˆ·è§’è‰² | `admin`, `user` |
| `email` | TEXT | æ˜¯ | - | æ¥æ”¶é€šçŸ¥çš„é‚®ç®± | `123@qq.com` |
| `smtp_host` | TEXT | æ˜¯ | `smtp.qq.com` | é‚®ç®± SMTP æœåŠ¡å™¨ | `smtp.qq.com` |
| `smtp_port` | INTEGER | æ˜¯ | 465 | é‚®ç®±ç«¯å£ | 465 |
| `smtp_user` | TEXT | æ˜¯ | - | é‚®ç®±è´¦å· | `123@qq.com` |
| `smtp_pass` | TEXT | æ˜¯ | - | é‚®ç®±æˆæƒç  | `abcxyz123` |
| `created_at` | TEXT | æ˜¯ | å½“å‰æ—¶é—´ | æ³¨å†Œæ—¶é—´ | `2026-02-24 10:00` |

---

### 2. è‡ªé€‰è‚¡è¡¨ (`watchlist`) â­æ ¸å¿ƒè¡¨

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | ä¸­æ–‡è¯´æ˜ | ä¸¾ä¾‹ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `id` | INTEGER | æ˜¯ | è‡ªå¢ | è®°å½•ç¼–å·ï¼ˆä¸»é”®ï¼‰ | 1, 2, 3 |
| `user_id` | INTEGER | æ˜¯ | - | ç”¨æˆ·ç¼–å·ï¼ˆå…³è” users è¡¨ï¼‰ | 1 |
| `stock_code` | TEXT | æ˜¯ | - | è‚¡ç¥¨ä»£ç  | `600519`, `AAPL` |
| `market` | TEXT | æ˜¯ | `CN` | å¸‚åœºç±»å‹ | `CN`, `HK`, `US` |
| `cost_price` | REAL | å¦ | 0 | æŒä»“æˆæœ¬å•ä»· | `1500.00` |
| `quantity` | INTEGER | å¦ | 0 | æŒä»“æ•°é‡ï¼ˆè‚¡ï¼‰ | `100` |
| `note` | TEXT | å¦ | - | å¤‡æ³¨ | `åº•ä»“`, `åŠ ä»“` |
| `created_at` | TEXT | æ˜¯ | å½“å‰æ—¶é—´ | æ·»åŠ æ—¶é—´ | `2026-02-24 10:00` |
| `updated_at` | TEXT | æ˜¯ | å½“å‰æ—¶é—´ | æœ€åæ›´æ–°æ—¶é—´ | `2026-02-24 15:30` |

**çº¦æŸè¯´æ˜ï¼š**
- `UNIQUE(user_id, stock_code)`ï¼šåŒä¸€ç”¨æˆ·ä¸èƒ½é‡å¤æ·»åŠ åŒä¸€åªè‚¡ç¥¨
- åªå…³æ³¨ä¸æŒä»“ï¼š`cost_price=0`, `quantity=0`
- å–å…‰äº†ï¼šæŠŠ `quantity` æ”¹ä¸º 0ï¼Œä¸åˆ é™¤è®°å½•

---

### 3. ç›‘æ§è§„åˆ™è¡¨ (`rules`)

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | ä¸­æ–‡è¯´æ˜ | ä¸¾ä¾‹ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `id` | INTEGER | æ˜¯ | è‡ªå¢ | è§„åˆ™ç¼–å·ï¼ˆä¸»é”®ï¼‰ | 1, 2, 3 |
| `user_id` | INTEGER | æ˜¯ | - | ç”¨æˆ·ç¼–å· | 1 |
| `stock_code` | TEXT | æ˜¯ | - | è‚¡ç¥¨ä»£ç  | `600519` |
| `condition` | TEXT | æ˜¯ | - | æ¡ä»¶ç±»å‹ | `price_low`, `price_high` |
| `target_value` | REAL | æ˜¯ | - | ç›®æ ‡ä»·æ ¼/æ¯”ä¾‹ | `1500.00` |
| `is_triggered` | INTEGER | æ˜¯ | 0 | æ˜¯å¦å·²è§¦å‘ (0=å¦ï¼Œ1=æ˜¯) | 0, 1 |
| `is_active` | INTEGER | æ˜¯ | 1 | è§„åˆ™æ˜¯å¦ç”Ÿæ•ˆ (0=å¦ï¼Œ1=æ˜¯) | 0, 1 |
| `created_at` | TEXT | æ˜¯ | å½“å‰æ—¶é—´ | åˆ›å»ºæ—¶é—´ | `2026-02-24 10:00` |

**æ¡ä»¶ç±»å‹è¯´æ˜ï¼š**
| æ¡ä»¶ä»£ç  | ä¸­æ–‡è¯´æ˜ | ç›®æ ‡å€¼ä¸¾ä¾‹ |
| :--- | :--- | :--- |
| `price_low` | è‚¡ä»·ä½äº | `1500` |
| `price_high` | è‚¡ä»·é«˜äº | `1600` |
| `change_pct_up` | æ¶¨å¹…è¶…è¿‡ | `5` (5%) |
| `change_pct_down` | è·Œå¹…è¶…è¿‡ | `-5` (-5%) |
| `cost_profit_pct` | ç›ˆåˆ©æ¯”ä¾‹è¶…è¿‡ | `10` (10%) |
| `cost_loss_pct` | äºæŸæ¯”ä¾‹è¶…è¿‡ | `-5` (-5%) |

---

### 4. æŠ¥è­¦æ—¥å¿—è¡¨ (`trigger_logs`)

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | ä¸­æ–‡è¯´æ˜ | ä¸¾ä¾‹ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `id` | INTEGER | æ˜¯ | è‡ªå¢ | æ—¥å¿—ç¼–å·ï¼ˆä¸»é”®ï¼‰ | 1, 2, 3 |
| `rule_id` | INTEGER | æ˜¯ | - | è§¦å‘çš„è§„åˆ™ç¼–å· | 1 |
| `user_id` | INTEGER | æ˜¯ | - | ç”¨æˆ·ç¼–å· | 1 |
| `stock_code` | TEXT | æ˜¯ | - | è‚¡ç¥¨ä»£ç  | `600519` |
| `trigger_price` | REAL | æ˜¯ | - | è§¦å‘æ—¶çš„ä»·æ ¼ | `1499.50` |
| `trigger_time` | TEXT | æ˜¯ | å½“å‰æ—¶é—´ | è§¦å‘æ—¶é—´ | `2026-02-24 10:05` |
| `email_status` | TEXT | æ˜¯ | `pending` | é‚®ä»¶å‘é€çŠ¶æ€ | `success`, `fail` |

---

### 5. ç³»ç»Ÿè¿è¡Œæ—¥å¿—è¡¨ (`system_logs`)

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | ä¸­æ–‡è¯´æ˜ | ä¸¾ä¾‹ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `id` | INTEGER | æ˜¯ | è‡ªå¢ | æ—¥å¿—ç¼–å·ï¼ˆä¸»é”®ï¼‰ | 1, 2, 3 |
| `log_time` | TEXT | æ˜¯ | å½“å‰æ—¶é—´ | è®°å½•æ—¶é—´ | `2026-02-24 10:00` |
| `log_type` | TEXT | æ˜¯ | `info` | æ—¥å¿—ç±»å‹ | `info`, `error`, `warning` |
| `message` | TEXT | æ˜¯ | - | æ—¥å¿—å†…å®¹ | `æˆåŠŸæŠ“å– 20 åªè‚¡ç¥¨` |
| `detail` | TEXT | å¦ | - | è¯¦ç»†ä¿¡æ¯ | `Error: Connection timeout` |

---

### 6. æ•°æ®æºé…ç½®è¡¨ (`data_sources`) â­

| å­—æ®µå | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | ä¸­æ–‡è¯´æ˜ | ä¸¾ä¾‹ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `id` | INTEGER | æ˜¯ | è‡ªå¢ | é…ç½®ç¼–å·ï¼ˆä¸»é”®ï¼‰ | 1 |
| `market` | TEXT | æ˜¯ | - | å¸‚åœºç±»å‹ | `CN`, `HK`, `US` |
| `source_name` | TEXT | æ˜¯ | - | æ•°æ®æºåç§° | `tushare`, `sina` |
| `api_key` | TEXT | å¦ | - | API å¯†é’¥/Token | `463dcf79...` |
| `poll_min_seconds` | INTEGER | æ˜¯ | 8 | æœ€å°è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰ | 8 |
| `poll_max_seconds` | INTEGER | æ˜¯ | 13 | æœ€å¤§è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰ | 13 |
| `is_active` | INTEGER | æ˜¯ | 1 | æ˜¯å¦å¯ç”¨ (0=å¦ï¼Œ1=æ˜¯) | 0, 1 |
| `updated_at` | TEXT | æ˜¯ | å½“å‰æ—¶é—´ | æœ€åæ›´æ–°æ—¶é—´ | `2026-02-24 10:00` |

**æ•°æ®æºå›ºå®šåˆ†é…ç­–ç•¥ï¼š**
| å¸‚åœº | æ•°æ®æº | è½®è¯¢é—´éš” | è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| `CN` (A è‚¡) | `tushare` | 8-13 ç§’ | ä»˜è´¹æ¥å£ï¼Œç¨³å®š |
| `HK` (æ¸¯è‚¡) | `sina` | 15-25 ç§’ | å…è´¹æ¥å£ |
| `US` (ç¾è‚¡) | `sina` | 15-25 ç§’ | ç›˜å‰/ç›˜åæ•°æ®å¯èƒ½å»¶è¿Ÿ |

**çº¦æŸè¯´æ˜ï¼š**
- `UNIQUE(market, source_name)`ï¼šæ¯ä¸ªå¸‚åœºé…ç½®ä¸€ä¸ªä¸»æ•°æ®æº
- ä¸æ”¯æŒæ™ºèƒ½åˆ‡æ¢ï¼ŒæŒ‰å¸‚åœºå›ºå®šåˆ†é…

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ (`init_db.py`)

```python
# -*- coding: utf-8 -*-
"""
è‚¡ç¥¨ç›‘æ§ç³»ç»Ÿ V1.0 - æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
è¿è¡Œåä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆ stock_monitor.db æ•°æ®åº“æ–‡ä»¶

æ•°æ®åº“è¡¨ç»“æ„è¯´æ˜ï¼š
1. users          - ç”¨æˆ·è¡¨ï¼ˆå­˜è´¦å·ã€å¯†ç ã€é‚®ç®±é…ç½®ï¼‰
2. watchlist      - è‡ªé€‰è‚¡è¡¨ï¼ˆå­˜å…³æ³¨è‚¡ç¥¨ + æŒä»“ä¿¡æ¯ï¼‰
3. rules          - ç›‘æ§è§„åˆ™è¡¨ï¼ˆå­˜æŠ¥è­¦è§„çŸ©ï¼‰
4. trigger_logs   - æŠ¥è­¦æ—¥å¿—è¡¨ï¼ˆå­˜è§¦å‘è®°å½•ï¼‰
5. system_logs    - ç³»ç»Ÿè¿è¡Œæ—¥å¿—è¡¨ï¼ˆå­˜ç³»ç»ŸçŠ¶æ€ï¼‰
6. data_sources   - æ•°æ®æºé…ç½®è¡¨ï¼ˆå­˜ Tushare/æ–°æµªé…ç½®ï¼‰
"""

import sqlite3
import os
import hashlib
from datetime import datetime

DB_PATH = 'stock_monitor.db'

def init_database():
    """åˆå§‹åŒ–æ•°æ®åº“ï¼Œåˆ›å»ºæ‰€æœ‰è¡¨"""
    
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    
    # ==========================================
    # 1. åˆ›å»ºç”¨æˆ·è¡¨ (users)
    # ä½œç”¨ï¼šå­˜ç”¨æˆ·è´¦å·ã€å¯†ç ã€é‚®ç®±é…ç½®ï¼ˆç”¨æ¥æ”¶æŠ¥è­¦é‚®ä»¶ï¼‰
    # ==========================================
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS users (
        id INTEGER PRIMARY KEY AUTOINCREMENT,     -- ç”¨æˆ·ç¼–å·ï¼ˆä¸»é”®ï¼‰
        username TEXT NOT NULL UNIQUE,            -- ç™»å½•ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
        password_hash TEXT NOT NULL,              -- åŠ å¯†åçš„å¯†ç 
        role TEXT NOT NULL DEFAULT 'user',        -- ç”¨æˆ·è§’è‰²ï¼ˆadmin/userï¼‰
        email TEXT NOT NULL,                      -- æ¥æ”¶é€šçŸ¥çš„é‚®ç®±
        smtp_host TEXT NOT NULL DEFAULT 'smtp.qq.com',  -- é‚®ç®± SMTP æœåŠ¡å™¨
        smtp_port INTEGER NOT NULL DEFAULT 465,   -- é‚®ç®±ç«¯å£
        smtp_user TEXT NOT NULL,                  -- é‚®ç®±è´¦å·
        smtp_pass TEXT NOT NULL,                  -- é‚®ç®±æˆæƒç 
        created_at TEXT NOT NULL                  -- æ³¨å†Œæ—¶é—´
    )
    ''')
    print("âœ… ç”¨æˆ·è¡¨ (users) åˆ›å»ºæˆåŠŸ")
    print("   å­—æ®µè¯´æ˜ï¼šid, username, password_hash, role, email, smtp_host, smtp_port, smtp_user, smtp_pass, created_at")
    
    # ==========================================
    # 2. åˆ›å»ºè‡ªé€‰è‚¡è¡¨ (watchlist)
    # ä½œç”¨ï¼šå­˜ç”¨æˆ·å…³æ³¨çš„è‚¡ç¥¨ + æŒä»“ä¿¡æ¯ï¼ˆç®€åŒ–è®¾è®¡ï¼ŒåˆäºŒä¸ºä¸€ï¼‰
    # ==========================================
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS watchlist (
        id INTEGER PRIMARY KEY AUTOINCREMENT,     -- è®°å½•ç¼–å·ï¼ˆä¸»é”®ï¼‰
        user_id INTEGER NOT NULL,                 -- ç”¨æˆ·ç¼–å·ï¼ˆå…³è” users è¡¨ï¼‰
        stock_code TEXT NOT NULL,                 -- è‚¡ç¥¨ä»£ç 
        market TEXT NOT NULL DEFAULT 'CN',        -- å¸‚åœºç±»å‹ï¼ˆCN/HK/USï¼‰
        cost_price REAL NOT NULL DEFAULT 0,       -- æŒä»“æˆæœ¬å•ä»·ï¼ˆæ— æŒä»“ä¸º 0ï¼‰
        quantity INTEGER NOT NULL DEFAULT 0,      -- æŒä»“æ•°é‡ï¼ˆè‚¡ï¼Œæ— æŒä»“ä¸º 0ï¼‰
        note TEXT,                                -- å¤‡æ³¨
        created_at TEXT NOT NULL,                 -- æ·»åŠ æ—¶é—´
        updated_at TEXT NOT NULL,                 -- æœ€åæ›´æ–°æ—¶é—´
        UNIQUE(user_id, stock_code),              -- åŒä¸€ç”¨æˆ·ä¸èƒ½é‡å¤æ·»åŠ åŒä¸€åªè‚¡ç¥¨
        FOREIGN KEY (user_id) REFERENCES users(id)
    )
    ''')
    print("âœ… è‡ªé€‰è‚¡è¡¨ (watchlist) åˆ›å»ºæˆåŠŸ")
    print("   å­—æ®µè¯´æ˜ï¼šid, user_id, stock_code, market, cost_price, quantity, note, created_at, updated_at")
    
    # ==========================================
    # 3. åˆ›å»ºç›‘æ§è§„åˆ™è¡¨ (rules)
    # ä½œç”¨ï¼šå­˜ç”¨æˆ·çš„æŠ¥è­¦è§„çŸ©ï¼ˆæ¯”å¦‚"è·Œç ´ 1500 å‘é‚®ä»¶"ï¼‰
    # ==========================================
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS rules (
        id INTEGER PRIMARY KEY AUTOINCREMENT,     -- è§„åˆ™ç¼–å·ï¼ˆä¸»é”®ï¼‰
        user_id INTEGER NOT NULL,                 -- ç”¨æˆ·ç¼–å·
        stock_code TEXT NOT NULL,                 -- è‚¡ç¥¨ä»£ç 
        condition TEXT NOT NULL,                  -- æ¡ä»¶ç±»å‹ï¼ˆprice_low/price_high ç­‰ï¼‰
        target_value REAL NOT NULL,               -- ç›®æ ‡ä»·æ ¼/æ¯”ä¾‹
        is_triggered INTEGER NOT NULL DEFAULT 0,  -- æ˜¯å¦å·²è§¦å‘ (0=å¦ï¼Œ1=æ˜¯)
        is_active INTEGER NOT NULL DEFAULT 1,     -- è§„åˆ™æ˜¯å¦ç”Ÿæ•ˆ (0=å¦ï¼Œ1=æ˜¯)
        created_at TEXT NOT NULL,                 -- åˆ›å»ºæ—¶é—´
        FOREIGN KEY (user_id) REFERENCES users(id)
    )
    ''')
    print("âœ… ç›‘æ§è§„åˆ™è¡¨ (rules) åˆ›å»ºæˆåŠŸ")
    print("   å­—æ®µè¯´æ˜ï¼šid, user_id, stock_code, condition, target_value, is_triggered, is_active, created_at")
    
    # ==========================================
    # 4. åˆ›å»ºæŠ¥è­¦æ—¥å¿—è¡¨ (trigger_logs)
    # ä½œç”¨ï¼šè®°å½•æ¯æ¬¡è§¦å‘æŠ¥è­¦çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ–¹ä¾¿æŸ¥è´¦ï¼‰
    # ==========================================
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS trigger_logs (
        id INTEGER PRIMARY KEY AUTOINCREMENT,     -- æ—¥å¿—ç¼–å·ï¼ˆä¸»é”®ï¼‰
        rule_id INTEGER NOT NULL,                 -- è§¦å‘çš„è§„åˆ™ç¼–å·
        user_id INTEGER NOT NULL,                 -- ç”¨æˆ·ç¼–å·
        stock_code TEXT NOT NULL,                 -- è‚¡ç¥¨ä»£ç 
        trigger_price REAL NOT NULL,              -- è§¦å‘æ—¶çš„ä»·æ ¼
        trigger_time TEXT NOT NULL,               -- è§¦å‘æ—¶é—´
        email_status TEXT NOT NULL DEFAULT 'pending',  -- é‚®ä»¶å‘é€çŠ¶æ€ (success/fail)
        FOREIGN KEY (rule_id) REFERENCES rules(id),
        FOREIGN KEY (user_id) REFERENCES users(id)
    )
    ''')
    print("âœ… æŠ¥è­¦æ—¥å¿—è¡¨ (trigger_logs) åˆ›å»ºæˆåŠŸ")
    print("   å­—æ®µè¯´æ˜ï¼šid, rule_id, user_id, stock_code, trigger_price, trigger_time, email_status")
    
    # ==========================================
    # 5. åˆ›å»ºç³»ç»Ÿè¿è¡Œæ—¥å¿—è¡¨ (system_logs)
    # ä½œç”¨ï¼šè®°å½•ç³»ç»Ÿè¿è¡Œæƒ…å†µï¼ˆæ¯”å¦‚æŠ“å–æˆåŠŸ/å¤±è´¥ï¼Œç®¡ç†å‘˜ä¸“ç”¨ï¼‰
    # ==========================================
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS system_logs (
        id INTEGER PRIMARY KEY AUTOINCREMENT,     -- æ—¥å¿—ç¼–å·ï¼ˆä¸»é”®ï¼‰
        log_time TEXT NOT NULL,                   -- è®°å½•æ—¶é—´
        log_type TEXT NOT NULL DEFAULT 'info',    -- æ—¥å¿—ç±»å‹ (info/error/warning)
        message TEXT NOT NULL,                    -- æ—¥å¿—å†…å®¹
        detail TEXT                               -- è¯¦ç»†ä¿¡æ¯
    )
    ''')
    print("âœ… ç³»ç»Ÿæ—¥å¿—è¡¨ (system_logs) åˆ›å»ºæˆåŠŸ")
    print("   å­—æ®µè¯´æ˜ï¼šid, log_time, log_type, message, detail")
    
    # ==========================================
    # 6. åˆ›å»ºæ•°æ®æºé…ç½®è¡¨ (data_sources)
    # ä½œç”¨ï¼šå­˜ Tushare/æ–°æµªç­‰æ•°æ®æºçš„é…ç½®ä¿¡æ¯ï¼ˆæŒ‰å¸‚åœºå›ºå®šåˆ†é…ï¼‰
    # ==========================================
    cursor.execute('''
    CREATE TABLE IF NOT EXISTS data_sources (
        id INTEGER PRIMARY KEY AUTOINCREMENT,     -- é…ç½®ç¼–å·ï¼ˆä¸»é”®ï¼‰
        market TEXT NOT NULL,                     -- å¸‚åœºç±»å‹ï¼ˆCN/HK/USï¼‰
        source_name TEXT NOT NULL,                -- æ•°æ®æºåç§°ï¼ˆtushare/sinaï¼‰
        api_key TEXT,                             -- API å¯†é’¥/Token
        poll_min_seconds INTEGER NOT NULL DEFAULT 8,    -- æœ€å°è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰
        poll_max_seconds INTEGER NOT NULL DEFAULT 13,   -- æœ€å¤§è½®è¯¢é—´éš”ï¼ˆç§’ï¼‰
        is_active INTEGER NOT NULL DEFAULT 1,     -- æ˜¯å¦å¯ç”¨ (0=å¦ï¼Œ1=æ˜¯)
        updated_at TEXT NOT NULL,                 -- æœ€åæ›´æ–°æ—¶é—´
        UNIQUE(market, source_name)               -- æ¯ä¸ªå¸‚åœºé…ç½®ä¸€ä¸ªä¸»æ•°æ®æº
    )
    ''')
    print("âœ… æ•°æ®æºé…ç½®è¡¨ (data_sources) åˆ›å»ºæˆåŠŸ")
    print("   å­—æ®µè¯´æ˜ï¼šid, market, source_name, api_key, poll_min_seconds, poll_max_seconds, is_active, updated_at")
    
    # ==========================================
    # æ’å…¥é»˜è®¤æ•°æ®
    # ==========================================
    now = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
    
    # A è‚¡ - Tushareï¼ˆå›ºå®šï¼‰
    cursor.execute('''
    INSERT OR IGNORE INTO data_sources 
    (market, source_name, api_key, poll_min_seconds, poll_max_seconds, is_active, updated_at)
    VALUES (?, ?, ?, ?, ?, ?, ?)
    ''', ('CN', 'tushare', '463dcf799d8bbd3ed514dd5c15d19cb9991d654e11498f852d6666da', 8, 13, 1, now))
    print("âœ… A è‚¡æ•°æ®æºé…ç½® (Tushare) æ’å…¥æˆåŠŸ")
    
    # æ¸¯è‚¡ - æ–°æµªï¼ˆå›ºå®šï¼‰
    cursor.execute('''
    INSERT OR IGNORE INTO data_sources 
    (market, source_name, api_key, poll_min_seconds, poll_max_seconds, is_active, updated_at)
    VALUES (?, ?, ?, ?, ?, ?, ?)
    ''', ('HK', 'sina', NULL, 15, 25, 1, now))
    print("âœ… æ¸¯è‚¡æ•°æ®æºé…ç½® (Sina) æ’å…¥æˆåŠŸ")
    
    # ç¾è‚¡ - æ–°æµªï¼ˆå›ºå®šï¼Œé¢„ç•™æ‰©å±•ï¼‰
    cursor.execute('''
    INSERT OR IGNORE INTO data_sources 
    (market, source_name, api_key, poll_min_seconds, poll_max_seconds, is_active, updated_at)
    VALUES (?, ?, ?, ?, ?, ?, ?)
    ''', ('US', 'sina', NULL, 15, 25, 1, now))
    print("âœ… ç¾è‚¡æ•°æ®æºé…ç½® (Sina) æ’å…¥æˆåŠŸ")
    
    # é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼ˆå¯†ç ï¼šadmin123ï¼Œå®é™…ä½¿ç”¨è¯·ä¿®æ”¹ï¼‰
    admin_pwd = hashlib.sha256('admin123'.encode()).hexdigest()
    cursor.execute('''
    INSERT OR IGNORE INTO users 
    (username, password_hash, role, email, smtp_user, smtp_pass, created_at)
    VALUES (?, ?, ?, ?, ?, ?, ?)
    ''', ('admin', admin_pwd, 'admin', 'admin@example.com', 'admin@example.com', '', now))
    print("âœ… é»˜è®¤ç®¡ç†å‘˜è´¦å·åˆ›å»ºæˆåŠŸï¼ˆç”¨æˆ·åï¼šadminï¼Œå¯†ç ï¼šadmin123ï¼‰")
    
    conn.commit()
    conn.close()
    
    print("\n" + "="*60)
    print(f"ğŸ‰ æ•°æ®åº“åˆå§‹åŒ–å®Œæˆï¼")
    print(f"ğŸ“ æ•°æ®åº“æ–‡ä»¶ï¼š{os.path.abspath(DB_PATH)}")
    print(f"ğŸ“Š æ•°æ®è¡¨æ•°é‡ï¼š6 å¼ ")
    print(f"ğŸ‘¤ é»˜è®¤ç®¡ç†å‘˜ï¼šadmin / admin123")
    print("="*60)
    print("\nâš ï¸  å®‰å…¨æç¤ºï¼š")
    print("   1. è¯·å°½å¿«ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç ")
    print("   2. Tushare Token è¯·å¦¥å–„ä¿ç®¡ï¼Œä¸è¦æ³„éœ²")
    print("   3. é‚®ç®±æˆæƒç å»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®")
    print("="*60)

if __name__ == '__main__':
    init_database()
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# 1. ä¿å­˜ä¸º init_db.py
# 2. è¿è¡Œè„šæœ¬
python init_db.py

# 3. ä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆ stock_monitor.db æ–‡ä»¶
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ¥å£è¯¦ç»†æ–‡æ¡£ï¼ˆå…± 29 ä¸ªæ¥å£ï¼‰

### ä¸€ã€ğŸ” è®¤è¯æ¨¡å— (Auth) - 4 ä¸ªæ¥å£

| æ–¹æ³• | æ¥å£åœ°å€ | åŠŸèƒ½ | è¾“å…¥å‚æ•° | è¿”å›ç¤ºä¾‹ |
| :--- | :--- | :--- | :--- | :--- |
| `POST` | `/api/auth/register` | æ³¨å†Œè´¦å· | `username`, `password`, `email` | `{"msg": "æ³¨å†ŒæˆåŠŸ"}` |
| `POST` | `/api/auth/login` | ç™»å½• | `username`, `password` | `{"token": "xxx", "role": "user"}` |
| `GET` | `/api/auth/profile` | æŸ¥çœ‹ä¸ªäººä¿¡æ¯ | (è‡ªåŠ¨è¯†åˆ«) | `{"email": "123@qq.com", "role": "user"}` |
| `PUT` | `/api/auth/profile` | ä¿®æ”¹ä¸ªäººä¿¡æ¯ | `email`, `smtp_host`, `smtp_pass` | `{"msg": "æ›´æ–°æˆåŠŸ"}` |

---

### äºŒã€ğŸ“Š ä»ªè¡¨ç›˜æ¨¡å— (Dashboard) - 1 ä¸ªæ¥å£

| æ–¹æ³• | æ¥å£åœ°å€ | åŠŸèƒ½ | è¾“å…¥å‚æ•° | è¿”å›ç¤ºä¾‹ |
| :--- | :--- | :--- | :--- | :--- |
| `GET` | `/api/dashboard` | è·å–è‡ªé€‰è‚¡ + å®æ—¶ä»·æ ¼ + ç›ˆäº | (è‡ªåŠ¨è¯†åˆ«) | è§ä¸‹æ–¹è¯¦ç»† |

**è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "items": [
    {
      "code": "600519",
      "name": "è´µå·èŒ…å°",
      "market": "CN",
      "price": 1500.50,
      "pre_close": 1495.00,
      "change_pct": 0.37,
      "status": "äº¤æ˜“ä¸­",
      "cost_price": 1450.00,
      "quantity": 100,
      "profit_loss": 5050.00,
      "profit_loss_pct": 3.48,
      "is_profit": true,
      "last_trade_time": "2026-02-24 15:00:00",
      "data_source": "tushare"
    },
    {
      "code": "AAPL",
      "name": "Apple Inc.",
      "market": "US",
      "price": 175.20,
      "pre_close": 174.00,
      "change_pct": 0.69,
      "status": "ç›˜å‰/ç›˜å",
      "cost_price": 170.00,
      "quantity": 50,
      "profit_loss": 260.00,
      "profit_loss_pct": 3.06,
      "is_profit": true,
      "is_extended": true,
      "last_trade_time": "2026-02-24 22:30:00",
      "data_source": "sina",
      "data_source_note": "ç›˜å‰/ç›˜åæ•°æ®å¯èƒ½å»¶è¿Ÿï¼Œå¤œç›˜æ—¶æ®µæ— æ•°æ®"
    }
  ],
  "summary": {
    "total_market_value": 158800.00,
    "total_cost": 153500.00,
    "total_profit_loss": 5300.00,
    "total_profit_loss_pct": 3.45
  },
  "last_sync": "2026-02-24 22:30:00"
}
```

**ğŸ‘¨â€ğŸ’» å‰ç«¯è®¡ç®—é€»è¾‘ï¼š**
```javascript
profit_loss = (price - cost_price) * quantity
profit_loss_pct = (price - cost_price) / cost_price * 100
```

---

### ä¸‰ã€ğŸ“ˆ è‡ªé€‰è‚¡æ¨¡å— (Stocks) - 4 ä¸ªæ¥å£

| æ–¹æ³• | æ¥å£åœ°å€ | åŠŸèƒ½ | è¾“å…¥å‚æ•° | è¿”å›ç¤ºä¾‹ |
| :--- | :--- | :--- | :--- | :--- |
| `GET` | `/api/stocks` | æŸ¥çœ‹è‡ªé€‰è‚¡åˆ—è¡¨ | (å¯é€‰ï¼šåˆ†é¡µ) | `[{"id": 1, "code": "600519"}]` |
| `POST` | `/api/stocks` | æ·»åŠ /æ›´æ–°è‚¡ç¥¨ | `code`, `market`, `cost_price`, `quantity` | `{"msg": "æ·»åŠ æˆåŠŸ"}` |
| `PUT` | `/api/stocks/{id}` | ä¿®æ”¹æŒä»“ä¿¡æ¯ | `cost_price`, `quantity`, `note` | `{"msg": "æ›´æ–°æˆåŠŸ"}` |
| `DELETE` | `/api/stocks/{id}` | åˆ é™¤è‚¡ç¥¨ | (URL é‡Œä¼  ID) | `{"msg": "åˆ é™¤æˆåŠŸ"}` |

---

### å››ã€âš ï¸ ç›‘æ§è§„åˆ™æ¨¡å— (Rules) - 4 ä¸ªæ¥å£

| æ–¹æ³• | æ¥å£åœ°å€ | åŠŸèƒ½ | è¾“å…¥å‚æ•° | è¿”å›ç¤ºä¾‹ |
| :--- | :--- | :--- | :--- | :--- |
| `GET` | `/api/rules` | æŸ¥çœ‹ç›‘æ§è§„åˆ™ | (å¯é€‰ï¼šæŒ‰è‚¡ç¥¨ç­›é€‰) | `[{"id": 1, "condition": "price_low"}]` |
| `POST` | `/api/rules` | æ–°å¢è§„åˆ™ | `code`, `condition`, `target_value` | `{"msg": "è®¾ç½®æˆåŠŸ"}` |
| `PUT` | `/api/rules/{id}` | ä¿®æ”¹/é‡ç½®è§„åˆ™ | `is_active`, `reset_trigger` | `{"msg": "æ›´æ–°æˆåŠŸ"}` |
| `DELETE` | `/api/rules/{id}` | åˆ é™¤è§„åˆ™ | (URL é‡Œä¼  ID) | `{"msg": "åˆ é™¤æˆåŠŸ"}` |

**ğŸ‘¨â€ğŸ’» é‡ç½®è§¦å‘è¯´æ˜ï¼š**
- è§„åˆ™è§¦å‘å `is_triggered=1`ï¼Œä¸ä¼šå†å‘é‚®ä»¶
- è°ƒç”¨æ­¤æ¥å£ä¼  `reset_trigger=true`ï¼Œå¯é‡ç½®ä¸º `is_triggered=0`

---

### äº”ã€ğŸ“œ æ—¥å¿—æ¨¡å— (Logs) - 3 ä¸ªæ¥å£

| æ–¹æ³• | æ¥å£åœ°å€ | åŠŸèƒ½ | è¾“å…¥å‚æ•° | æƒé™ |
| :--- | :--- | :--- | :--- | :--- |
| `GET` | `/api/logs/alerts` | æŸ¥çœ‹æŠ¥è­¦å†å² | (å¯é€‰ï¼šåˆ†é¡µã€æ—¶é—´èŒƒå›´) | æ‰€æœ‰ç”¨æˆ· |
| `GET` | `/api/logs/system` | æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿— | (å¯é€‰ï¼šåˆ†é¡µã€ç±»å‹) | **ä»…ç®¡ç†å‘˜** |
| `GET` | `/api/logs/positions` | æŸ¥çœ‹æŒä»“å˜åŠ¨ | (å¯é€‰ï¼šè‚¡ç¥¨ä»£ç ) | æ‰€æœ‰ç”¨æˆ· |

---

### å…­ã€ğŸ”§ ç³»ç»Ÿç®¡ç†æ¨¡å— (System) - 9 ä¸ªæ¥å£

| æ–¹æ³• | æ¥å£åœ°å€ | åŠŸèƒ½ | è¾“å…¥å‚æ•° | æƒé™ |
| :--- | :--- | :--- | :--- | :--- |
| `GET` | `/api/system/status` | ç³»ç»Ÿå¥åº·æ£€æŸ¥ | (æ— éœ€è¾“å…¥) | æ‰€æœ‰ç”¨æˆ· |
| `POST` | `/api/system/refresh` | å¼ºåˆ¶åˆ·æ–°è‚¡ä»· | (æ— éœ€è¾“å…¥) | æ‰€æœ‰ç”¨æˆ· |
| `GET` | `/api/admin/users` | ç”¨æˆ·åˆ—è¡¨ | (å¯é€‰ï¼šåˆ†é¡µ) | **ä»…ç®¡ç†å‘˜** |
| `PUT` | `/api/admin/users/{id}` | ä¿®æ”¹ç”¨æˆ·è§’è‰² | `role` | **ä»…ç®¡ç†å‘˜** |
| `GET` | `/api/admin/data-sources` | æ•°æ®æºé…ç½®åˆ—è¡¨ | (æ— éœ€è¾“å…¥) | **ä»…ç®¡ç†å‘˜** |
| `POST` | `/api/admin/data-sources` | æ–°å¢æ•°æ®æºé…ç½® | `market`, `source_name`, `api_key`, `poll_min`, `poll_max` | **ä»…ç®¡ç†å‘˜** |
| `PUT` | `/api/admin/data-sources/{market}` | ä¿®æ”¹æ•°æ®æºé…ç½® | `source_name`, `api_key`, `poll_min`, `poll_max`, `is_active` | **ä»…ç®¡ç†å‘˜** |
| `DELETE` | `/api/admin/data-sources/{id}` | åˆ é™¤æ•°æ®æºé…ç½® | (URL é‡Œä¼  ID) | **ä»…ç®¡ç†å‘˜** |
| `GET` | `/api/admin/data-sources/active` | è·å–å½“å‰å¯ç”¨çš„æ•°æ®æº | (æ— éœ€è¾“å…¥) | **ä»…ç®¡ç†å‘˜** |

**æ•°æ®æºé…ç½®è¿”å›ç¤ºä¾‹ï¼š**
```json
{
  "items": [
    {
      "market": "CN",
      "source_name": "tushare",
      "api_key": "463dcf79...",
      "poll_min_seconds": 8,
      "poll_max_seconds": 13,
      "is_active": 1,
      "updated_at": "2026-02-24 10:00:00"
    },
    {
      "market": "HK",
      "source_name": "sina",
      "api_key": null,
      "poll_min_seconds": 15,
      "poll_max_seconds": 25,
      "is_active": 1,
      "updated_at": "2026-02-24 10:00:00"
    },
    {
      "market": "US",
      "source_name": "sina",
      "api_key": null,
      "poll_min_seconds": 15,
      "poll_max_seconds": 25,
      "is_active": 1,
      "note": "ç›˜å‰/ç›˜åæ•°æ®å¯èƒ½å»¶è¿Ÿï¼Œå¤œç›˜æ—¶æ®µæ— æ•°æ®",
      "updated_at": "2026-02-24 10:00:00"
    }
  ],
  "total": 3
}
```

---

### ä¸ƒã€ğŸ“¡ å¤–éƒ¨æ•°æ®æºæ¥å£ï¼ˆåç«¯å†…éƒ¨è°ƒç”¨ï¼‰- 4 ä¸ªæ¥å£

è¿™éƒ¨åˆ†æ¥å£æ˜¯**åç«¯ä»£ç è°ƒç”¨å¤–éƒ¨æœåŠ¡**è·å–è‚¡ç¥¨è¡Œæƒ…çš„ï¼Œä¸æš´éœ²ç»™å‰ç«¯ã€‚

| æ•°æ®æº | æ¥å£åç§° | é€‚ç”¨å¸‚åœº | éœ€è¦è®¤è¯ | ä»£ç ä½ç½® |
| :--- | :--- | :--- | :--- | :--- |
| **Tushare** | `ts.get_realtime_quotes()` | A è‚¡ (CN) | æ˜¯ (Token) | `test.py` ç¬¬ 45-56 è¡Œ |
| **æ–°æµª** | `hq.sinajs.cn/list` | æ¸¯è‚¡ (HK) | å¦ | `test.py` ç¬¬ 58-82 è¡Œ |
| **æ–°æµª** | `hq.sinajs.cn/list` | ç¾è‚¡ (US) | å¦ | `test.py` ç¬¬ 58-82 è¡Œ |
| **ä¸œæ–¹è´¢å¯Œ** | `push2.eastmoney.com` | å¤‡ç”¨ | å¦ | V2.0 æ‰©å±• |

**Tushare è°ƒç”¨ç¤ºä¾‹ï¼š**
```python
import tushare as ts
ts.set_token('463dcf79...')
df = ts.get_realtime_quotes('600519')
```

**æ–°æµªè°ƒç”¨ç¤ºä¾‹ï¼š**
```python
import requests
# æ¸¯è‚¡
resp = requests.get("https://hq.sinajs.cn/list=rt_hk00700")
# ç¾è‚¡
resp = requests.get("https://hq.sinajs.cn/list=gb_aapl")
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šæ¥å£æƒé™å¯¹ç…§è¡¨

| æ¥å£æ¨¡å— | æ™®é€šç”¨æˆ· (user) | ç®¡ç†å‘˜ (admin) |
| :--- | :--- | :--- |
| è®¤è¯æ¨¡å— | âœ… å…¨éƒ¨å¯ç”¨ | âœ… å…¨éƒ¨å¯ç”¨ |
| ä»ªè¡¨ç›˜æ¨¡å— | âœ… æŸ¥çœ‹è‡ªå·±çš„ | âœ… æŸ¥çœ‹å…¨éƒ¨ |
| è‡ªé€‰è‚¡æ¨¡å— | âœ… ç®¡ç†è‡ªå·±çš„ | âœ… ç®¡ç†è‡ªå·±çš„ |
| ç›‘æ§è§„åˆ™æ¨¡å— | âœ… ç®¡ç†è‡ªå·±çš„ | âœ… ç®¡ç†è‡ªå·±çš„ |
| æ—¥å¿— - æŠ¥è­¦ | âœ… æŸ¥çœ‹è‡ªå·±çš„ | âœ… æŸ¥çœ‹å…¨éƒ¨ |
| æ—¥å¿— - ç³»ç»Ÿ | âŒ æ— æƒé™ | âœ… æŸ¥çœ‹å…¨éƒ¨ |
| ç³»ç»ŸçŠ¶æ€ | âœ… æŸ¥çœ‹ | âœ… æŸ¥çœ‹ + åˆ·æ–° |
| ç”¨æˆ·ç®¡ç† | âŒ æ— æƒé™ | âœ… å…¨éƒ¨å¯ç”¨ |
| æ•°æ®æºé…ç½® | âŒ æ— æƒé™ | âœ… å…¨éƒ¨å¯ç”¨ |

---

## ç¬¬äº”éƒ¨åˆ†ï¼šå®Œæ•´æ¥å£æ¸…å•ï¼ˆå…± 29 ä¸ªï¼‰

| æ¨¡å— | æ¥å£æ•°é‡ | æ¥å£åˆ—è¡¨ |
| :--- | :--- | :--- |
| ğŸ” è®¤è¯æ¨¡å— | 4 ä¸ª | register, login, profile(GET/PUT) |
| ğŸ“Š ä»ªè¡¨ç›˜æ¨¡å— | 1 ä¸ª | dashboard |
| ğŸ“ˆ è‡ªé€‰è‚¡æ¨¡å— | 4 ä¸ª | stocks(GET/POST/PUT/DELETE) |
| âš ï¸ ç›‘æ§è§„åˆ™æ¨¡å— | 4 ä¸ª | rules(GET/POST/PUT/DELETE) |
| ğŸ“œ æ—¥å¿—æ¨¡å— | 3 ä¸ª | alerts, system, positions |
| ğŸ”§ ç³»ç»Ÿç®¡ç†æ¨¡å— | 9 ä¸ª | status, refresh, users(GET/PUT), data-sources(GET/POST/PUT/DELETE/active) |
| ğŸ“¡ å¤–éƒ¨æ•°æ®æº | 4 ä¸ª | tushare_get_realtime_quotes, sina_hq_sinajs(HK), sina_hq_sinajs(US), eastmoney_push2 |
| **åˆè®¡** | **29 ä¸ª** | |

---

## ç¬¬å…­éƒ¨åˆ†ï¼šå¼€å‘é¡ºåºå»ºè®®

```
ç¬¬ 1 æ­¥ï¼šè¿è¡Œ init_db.py åˆ›å»ºæ•°æ®åº“
        â†“
ç¬¬ 2 æ­¥ï¼šä¿®æ”¹ test.pyï¼Œè¿æ¥æ•°æ®åº“ï¼ˆè¯»å– watchlist è¡¨ï¼‰
        â†“
ç¬¬ 3 æ­¥ï¼šå®ç°åå°è‡ªåŠ¨è½®è¯¢ï¼ˆSchedulerï¼‰
        â†“
ç¬¬ 4 æ­¥ï¼šå®ç° /api/auth/login å’Œ /api/auth/register
        â†“
ç¬¬ 5 æ­¥ï¼šå®ç° /api/dashboardï¼ˆæ ¸å¿ƒæ¥å£ï¼‰
        â†“
ç¬¬ 6 æ­¥ï¼šå®ç° /api/stocks å’Œ /api/rules
        â†“
ç¬¬ 7 æ­¥ï¼šå®ç°é‚®ä»¶å‘é€åŠŸèƒ½
        â†“
ç¬¬ 8 æ­¥ï¼šå†™ç®€å•çš„å‰ç«¯é¡µé¢
```

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå¸¸è§é”™è¯¯ç 

| çŠ¶æ€ç  | å«ä¹‰ | å¦‚ä½•å¤„ç† |
| :--- | :--- | :--- |
| `200` | æˆåŠŸ | æ­£å¸¸å¤„ç† |
| `401` | æœªç™»å½•/Token è¿‡æœŸ | è·³è½¬ç™»å½•é¡µ |
| `403` | æƒé™ä¸è¶³ | æç¤º"éœ€è¦ç®¡ç†å‘˜æƒé™" |
| `404` | èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥ ID æ˜¯å¦æ­£ç¡® |
| `500` | æœåŠ¡å™¨é”™è¯¯ | æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿— |

---

## ç¬¬å…«éƒ¨åˆ†ï¼šæ–‡æ¡£æ€»ç»“

| é¡¹ç›® | æ•°é‡/è¯´æ˜ |
| :--- | :--- |
| æ•°æ®åº“è¡¨ | 6 å¼  |
| æ¥å£æ€»æ•° | 29 ä¸ªï¼ˆ25 ä¸ªå†…éƒ¨ + 4 ä¸ªå¤–éƒ¨ï¼‰ |
| æƒé™è§’è‰² | 2 ç§ï¼ˆadmin, userï¼‰ |
| æ•°æ®æºç­–ç•¥ | æŒ‰å¸‚åœºå›ºå®šåˆ†é…ï¼ˆä¸æ™ºèƒ½åˆ‡æ¢ï¼‰ |
| æŒä»“ç®¡ç† | ç®€åŒ–è®¾è®¡ï¼ˆåˆå¹¶åˆ° watchlist è¡¨ï¼‰ |
| æ—¶é—´æ˜¾ç¤º | ç»Ÿä¸€è½¬ä¸ºåŒ—äº¬æ—¶é—´ |
| éƒ¨ç½²æ–¹å¼ | Docker å®¹å™¨åŒ– |

---

è¿™ä»½æ–‡æ¡£å·²å®Œæ•´è¦†ç›– V1.0 ç‰ˆæœ¬çš„æ‰€æœ‰éœ€æ±‚ï¼Œå¯ä»¥ç›´æ¥ç”¨äºå¼€å‘ï¼ğŸš€
